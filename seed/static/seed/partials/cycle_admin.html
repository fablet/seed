<div class="page_header_container">
    <div class="page_header">
        <div class="left page_action_container">
            <a ui-sref="organizations" class="page_action"><i class="fa fa-chevron-left"></i> Organizations</a>
        </div>
        <div class="page_title">
            <h1>{$ org.name $}</h1>
        </div>
        <div class="right page_action_container">
        </div>
    </div>
</div>
<div class="section_nav_container" ng-include="urls.static_url + 'seed/partials/accounts_nav.html'"></div>
<div id="cycle_admin" class="container-fluid">
                
    <div class="newCycleInput">
        
        <form   name="newCycleForm"
                class="form-inline"
                role="form"
                ng-submit="submitNewCycleForm(newCycleForm)"
                novalidate>
            
            <div class="form-group"
                 ng-class="{'has-error': newCycleForm.name.$invalid &&
                                            newCycleForm.name.$dirty }">
                <label  class="control-label sectionLabel"
                        style="padding-right:20px;">
                        Create new cycle</label>
                <div    class="input-group"
                        style="padding-right:20px;">
                    <input  type="text"
                            name="name"
                            class="form-control"
                            ng-minlength="1"
                            ng-maxlength="100"
                            style="min-width:300px;"
                            ng-model="new_cycle.name"
                            placeholder="Cycle Name"
                            sd-check-cycle-exists="cycles"
                            required>
                </div>
            </div> <!-- ./form-group -->
            
            <div class="form-group"
                 ng-class="{'has-error' : invalidCreateDates }">
                <label for="createFromDatePicker">From date:</label>
                <div class="input-group date-input" style="padding-right:20px;">
                    <input  id="createFromDatePicker"
                            is-open="showCreateFromDatePicker"
                            type="text"
                            class="form-control"
                            uib-datepicker-popup="MM-dd-yyyy"
                            ng-model="createFromDate"
                            required
                            uib-tooltip="'From Date' must be before 'To Date'"
                            tooltip-placement="top"
                            tooltip-trigger="mouseenter"
                            tooltip-enable="invalidCreateDates"
                            />
                    <span class="input-group-btn">
                        <button type="button"
                                class="btn btn-default"
                                ng-click="openDatePicker('showCreateFromDatePicker')"><i class="fa fa-calendar"></i></button>
                    </span>
                </div>
            </div> <!-- ./form-group -->
                
            <div class="form-group" >
                <label for="createToDatePicker">To date:</label>
                <div class="input-group date-input" style="padding-right:20px;">
                    <input  id="createToDatePicker"
                            is-open="showCreateToDatePicker"
                            type="text"
                            class="form-control"
                            uib-datepicker-popup="MM-dd-yyyy"
                            ng-model="createToDate"
                            required
                            >
                    <span class="input-group-btn">
                        <button type="button"
                                class="btn btn-default"
                                ng-click="openDatePicker('showCreateToDatePicker')"><i class="fa fa-calendar"></i></button>
                    </span>
                </div>
            </div> <!-- ./form-group -->
            
            <button id="btnCreateCycle"
                    class="btn btn-primary"
                    ng-disabled="newCycleForm.$invalid || invalidCreateDates===false">
                    Create Cycle</button>
            <div class="help-block">
                <span   class="has-error"
                        ng-show="newCycleForm.name.$error.sdCheckCycleExists">
                        This cycle name is already taken.
                </span>
            </div>
            
        </form>
    </div>


    <div style="padding-left:10px;" class="sectionLabel">
        <p><b>Existing Cycles</b></p>
    </div>
     
    <div class="table_list_container">
        <table class="table table-striped table-hover table-condensed">

            <tr class="tableHeader">
              <td style="width:40%;padding-left:10px;">Name</td>
              <td style="width:25%">From Date</td>
              <td style="width:25%">To Date</td>
              <td width="width:10%" align="right"></td>
            </tr>

            <tr ng-repeat="cycle in cycles">
                
                <td style="border:0px; padding-left:10px; vertical-align:middle;">
                    <span   editable-text="cycle.name"
                            e-name="name"
                            e-form="rowform"
                            ng-show="rowform.$visible"
                            onbeforesave="checkEditCycleBeforeSave($data, cycle.name)"
                            e-ng-keypress="onEditCycleNameKeypress($event, rowform)"
                            e-maxlength="255"
                            e-required>
                        {$ cycle.name $}
                    </span>
                    <span   ng-show="!rowform.$visible">
                        {$ cycle.name $}
                    </span>
                </td>
                
                <td style="border:0px; padding-left:10px; vertical-align:middle;">
                    <div class="input-group date-input"
                         ng-show="rowform.$visible"
                         style="padding-right:20px;">
                        <input  id="editFromDatePicker"
                                is-open="showEditFromDatePicker"
                                type="text"
                                class="form-control"
                                uib-datepicker-popup="MM-dd-yyyy"
                                ng-model="editFromDate"
                                uib-tooltip="'From Date' must be before 'To Date'"
                                tooltip-placement="top"
                                tooltip-trigger="mouseenter"
                                tooltip-enable="invalidEditDates"
                                />
                        <span class="input-group-btn">
                            <button type="button"
                                    class="btn btn-default"
                                    ng-click="openDatePicker('showEditFromDatePicker')"><i class="fa fa-calendar"></i></button>
                        </span>
                    </div>
                     <span  ng-show="!rowform.$visible">
                         {$ cycle.from_date $}
                    </span>
                </td>

                <td style="border:0px; padding-left:10px; vertical-align:middle;">
                    <div class="input-group date-input"
                         ng-show="rowform.$visible"
                         style="padding-right:20px;">
                        <input  id="showEditToDP"
                                is-open="showEditToDatePicker"
                                type="text"
                                class="form-control"
                                uib-datepicker-popup="MM-dd-yyyy"
                                ng-model="editToDate"/>
                        <span class="input-group-btn">
                            <button type="button"
                                    class="btn btn-default"
                                    ng-click="openDatePicker('showEditToDatePicker')"><i class="fa fa-calendar"></i></button>
                        </span>
                    </div>
                    <span  ng-show="!rowform.$visible">
                          {$ cycle.to_date $}
                    </span>
                </td>
                
                <td style="white-space: nowrap; border:0px;" align="right">

                    <!-- form -->
                    <form   editable-form name="rowform"
                            onbeforesave="saveCycle($data, cycle.id, $index)"
                            ng-show="rowform.$visible"
                            class="form-buttons form-inline"
                            shown="inserted == cycle">
                      <button   type="submit"
                                ng-disabled="rowform.$waiting"
                                class="btn btn-primary btn-rowform">
                        save
                      </button>
                      <button   type="button"
                                ng-disabled="rowform.$waiting"
                                ng-click="rowform.$cancel()"
                                class="btn btn-default btn-rowform">
                        cancel
                      </button>
                    </form>

                    <div class="buttons" ng-show="!rowform.$visible">
                      <button   class="btn btn-default  btn-rowform"
                                ng-click="rowform.$show()">
                                edit</button>
	                    <!--
                      <button   class="btn btn-danger btn-rowform"
                                ng-click="deleteLabel(cycle, $index)">
                                X</button>
                      -->
                    </div>

                </td>

            </tr>
        </table>
    </div>
   
</div>
